{% extends "layout.html" %}
{% block content %}
<h2>Detalji preknjižavanja</h2>

<div class="card">
    <div class="card-header">
        <h3>Osnovni podaci</h3>
    </div>
    <div class="card-body">
        <div class="row">
            <div class="col-md-6">
                <p><strong>Datum preknjižavanja:</strong> {{ transfer.transfer_date.strftime('%d.%m.%Y.') }}</p>
                <p><strong>Đak:</strong> {{ transfer.student.student_name }} {{ transfer.student.student_surname }}</p>
                <p><strong>Razred/odeljenje:</strong> {{ transfer.student.student_class }}/{{ transfer.student.student_section }}</p>
            </div>
            <div class="col-md-6">
                <p><strong>Sa usluge:</strong> {{ transfer.source_service.service_item_service.service_name }} - {{ transfer.source_service.service_item_name }}</p>
                <p><strong>Na uslugu:</strong> {{ transfer.target_service.service_item_service.service_name }} - {{ transfer.target_service.service_item_name }}</p>
                <p><strong>Iznos:</strong> {{ transfer.amount|round(2) }}</p>
                {% if transfer.note %}
                <p><strong>Napomena:</strong> {{ transfer.note }}</p>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<div class="card mt-4">
    <div class="card-header">
        <h3>Povezane transakcije</h3>
    </div>
    <div class="card-body">
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Usluga</th>
                    <th>Iznos</th>
                    <th>Svrha plaćanja</th>
                </tr>
            </thead>
            <tbody>
                {% for transaction in transactions %}
                <tr>
                    <td>{{ transaction.transaction_record_service_item.service_item_service.service_name }} - {{ transaction.transaction_record_service_item.service_item_name }}</td>
                    <td {% if transaction.student_debt_total < 0 %}class="text-success"{% else %}class="text-danger"{% endif %}>
                        {{ transaction.student_debt_total|round(2) }}
                    </td>
                    <td>{{ transaction.purpose_of_payment }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<div class="mt-4">
    <a href="{{ url_for('transactions.transfers_list') }}" class="btn btn-secondary">Nazad na listu preknjižavanja</a>
</div>
{% endblock %}
